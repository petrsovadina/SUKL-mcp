# Smithery Deployment Configuration
# https://smithery.ai/docs

# Runtime - MUSÍ být "container" pro Python servery
runtime: "container"

# Server start command configuration
startCommand:
  type: "http"

  # Configuration schema pro uživatele
  configSchema:
    type: "object"
    properties:
      cacheDir:
        type: "string"
        title: "Cache Directory"
        description: "Directory for caching downloaded SÚKL data"
        default: "/tmp/sukl_dlp_cache"
      dataDir:
        type: "string"
        title: "Data Directory"
        description: "Directory for extracted CSV data"
        default: "/tmp/sukl_dlp_data"
      downloadTimeout:
        type: "number"
        title: "Download Timeout (seconds)"
        description: "Timeout for downloading SÚKL Open Data ZIP"
        default: 120.0
        minimum: 30
        maximum: 600
      logLevel:
        type: "string"
        title: "Log Level"
        description: "Logging level for server"
        enum: ["DEBUG", "INFO", "WARNING", "ERROR"]
        default: "INFO"

  # Example configuration
  exampleConfig:
    cacheDir: "/tmp/sukl_dlp_cache"
    dataDir: "/tmp/sukl_dlp_data"
    downloadTimeout: 120.0
    logLevel: "INFO"

# Metadata
metadata:
  name: "SÚKL MCP Server"
  displayName: "SÚKL MCP Server"
  version: "5.0.2"
  description: "Production-ready FastMCP server pro přístup k české databázi léčivých přípravků SÚKL (68,248 přípravků)"
  author: "FastMCP Community"
  license: "MIT"
  homepage: "https://github.com/petrsovadina/SUKL-mcp"
  repository: "https://github.com/petrsovadina/SUKL-mcp"

  # Tags pro Smithery registry
  tags:
    - "healthcare"
    - "pharmaceuticals"
    - "czech"
    - "database"
    - "fastmcp"

  # Kategorie
  categories:
    - "data"
    - "healthcare"

# Docker build configuration
build:
  context: "."
  dockerfile: "Dockerfile"

# Environment mapping (Smithery config → Docker ENV)
environment:
  SUKL_CACHE_DIR: "{{ config.cacheDir }}"
  SUKL_DATA_DIR: "{{ config.dataDir }}"
  SUKL_DOWNLOAD_TIMEOUT: "{{ config.downloadTimeout }}"
  LOG_LEVEL: "{{ config.logLevel }}"
  MCP_TRANSPORT: "http"
  MCP_HOST: "0.0.0.0"
  MCP_PORT: "8000"

# Resource requirements
resources:
  memory: "512Mi"  # pandas může být memory-hungry při načítání CSV
  cpu: "500m"

# Health check
healthCheck:
  path: "/health"
  port: 8000
  initialDelaySeconds: 30
  periodSeconds: 30
  timeoutSeconds: 10
